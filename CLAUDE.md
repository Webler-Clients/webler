# CLAUDE.md - Base-Minimal Development Guide

This file provides guidance to Claude Code when working with the `base-minimal` repository.

## Project Purpose

**Base-minimal** is a truly minimal Astro starter for **unconstrained AI website generation**. Unlike `base-template` which uses pre-built components, base-minimal gives the AI complete creative freedom to generate websites from scratch.

## Core Philosophy

**Zero Templates = Maximum Creativity**

- No pre-built components to influence design decisions
- No template structure to limit layout experimentation
- No legacy patterns or conventions to carry over
- Complete freedom for AI to make all design decisions
- Latest tech stack with zero constraints

## Tech Stack

```json
{
  "framework": "Astro 5.16+",
  "styling": "Tailwind CSS 4.1+ (CSS-first, no config file)",
  "typescript": "Strict mode",
  "interactive": "React 19 (islands architecture)",
  "animations": "Framer Motion",
  "icons": "lucide-react",
  "deployment": "Netlify (automatic PR previews)"
}
```

## Project Structure

```
base-minimal/
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ generate-client-site.yml    # AI generation workflow
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.astro            # Root page (minimal)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clients/               # AI-generated websites
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ [business-name]/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ index.astro    # Generated by AI (complete website)
‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ       ‚îî‚îÄ‚îÄ global.css             # @import "tailwindcss" only
‚îú‚îÄ‚îÄ public/                        # Static assets
‚îú‚îÄ‚îÄ astro.config.mjs              # Minimal config (Tailwind + React)
‚îú‚îÄ‚îÄ tsconfig.json                 # TypeScript strict mode
‚îî‚îÄ‚îÄ package.json                  # Dependencies
```

## How AI Generation Works

### 1. Workflow Trigger

The GitHub Actions workflow can be triggered via:

**Manual (workflow_dispatch):**
```bash
# Via GitHub Actions UI
Actions ‚Üí Generate Client Site ‚Üí Run workflow
```

**API (repository_dispatch):**
```typescript
// From Convex or other services
await octokit.repos.createDispatchEvent({
  owner: 'WebAsAService',
  repo: 'base-minimal',
  event_type: 'generate-client-site',
  client_payload: {
    businessName: 'Acme Corp',
    industry: 'Technology',
    services: ['Web Development', 'Consulting'],
    colors: { primary: '#3b82f6', secondary: '#8b5cf6', accent: '#ec4899' },
    email: 'contact@acmecorp.com',
    generationType: 'full'
  }
});
```

### 2. AI Generation Process

The workflow (`generate-client-site.yml`) performs these steps:

1. **Setup** - Install Node.js, Python, dependencies
2. **Input Parsing** - Extract business info from workflow/API inputs
3. **Branch Creation** - Create feature branch for this client
4. **AI Generation** - Call Claude API with complete business context
5. **File Creation** - Write generated `index.astro` to `src/pages/clients/[name]/`
6. **Commit & Push** - Stage, commit, and push generated files
7. **PR Creation** - Open pull request with generated content
8. **Webhook Notification** - Send status updates to caller

### 3. AI Prompt

The workflow creates a Python script that prompts Claude with:

```python
Generate a complete, production-ready Astro website for:
- Business Name: [name]
- Industry: [industry]
- Services: [list]
- Target Audience: [audience]
- Brand Colors: [primary, secondary, accent]
- Contact: [email, phone]

Technical requirements:
- Single-page Astro file (index.astro)
- Tailwind CSS classes only (no custom CSS files)
- Import global.css for Tailwind base
- React islands for interactivity (optional)
- Framer Motion for animations (optional)
- lucide-react icons where appropriate
- Mobile-responsive, accessible, SEO-optimized
- Industry-appropriate design aesthetic

Generate ONLY the code, no explanations.
```

**Key Innovation**: The AI generates the **entire website** in one Claude API call - no templates, scripts, or constraints.

## Development Commands

```bash
# Install dependencies
npm install

# Start dev server (http://localhost:4321)
npm run dev

# Build production site
npm run build

# Preview production build
npm run preview

# Run Astro CLI
npm run astro ...
```

## File Operation Guidelines

### Creating New Files

Only create files in these locations:
- `src/pages/clients/[business-name]/index.astro` - Generated websites
- Documentation updates (README.md, this file)
- Workflow updates (.github/workflows/)

### DO NOT Create

- ‚ùå Component libraries (`src/components/`)
- ‚ùå Layout files (`src/layouts/`)
- ‚ùå Shared utilities (`src/utils/`)
- ‚ùå Custom CSS files (`src/styles/*.css` except global.css)
- ‚ùå Template files or examples

**Why**: Base-minimal is intentionally minimal. Adding components or templates defeats the purpose.

## Workflow Modification

If modifying `generate-client-site.yml`:

1. **Preserve webhook integration** - Status updates are critical for UX
2. **Maintain input compatibility** - Both workflow_dispatch and repository_dispatch
3. **Keep AI prompt structure** - Single-call complete generation
4. **Test thoroughly** - Workflow failures are user-facing

### Webhook Statuses

The workflow sends these status webhooks:

```typescript
type WebhookStatus =
  | 'started'           // Workflow initiated
  | 'initializing'      // Workspace setup complete
  | 'ai_analyzing'      // AI analyzing business requirements
  | 'content_generated' // Website generated successfully
  | 'pr_created'        // Pull request created
  | 'completed'         // Workflow successful (includes preview_url)
  | 'failed'            // Workflow failed (includes error)
```

## Netlify Configuration

### Required Setup

1. **Connect Repository**: Netlify ‚Üí Add site ‚Üí `WebAsAService/base-minimal`
2. **Build Settings**:
   ```
   Build command: npm run build
   Publish directory: dist
   ```
3. **Enable PR Previews**: Settings ‚Üí Build & deploy ‚Üí Deploy contexts ‚Üí Enable

### Preview URLs

After PR creation, Netlify auto-generates:
```
https://deploy-preview-[PR-NUMBER]--base-minimal.netlify.app/clients/[business-name]/
```

The workflow automatically constructs this URL and includes it in the completion webhook.

## GitHub Secrets

Required in repository settings:

```
ANTHROPIC_API_KEY     # Claude API key (required)
STATUS_WEBHOOK_URL    # Webhook endpoint for status updates (optional)
GITHUB_TOKEN          # Auto-provided by GitHub Actions
```

## Integration with WaaS Ecosystem

### Repository Routing

```typescript
// In Convex or client-portal
if (generationType === 'full') {
  // Use base-minimal for unconstrained AI generation
  await triggerGitHubWorkflow('base-minimal', payload);
} else {
  // Use base-template for template-based generation
  await triggerGitHubWorkflow('base-template', payload);
}
```

### Data Flow

```
User Form Submission
  ‚Üí Client Portal (collects data)
    ‚Üí Convex SaaS Backend (stores, triggers)
      ‚Üí Base-Minimal GitHub Workflow (generates)
        ‚Üí Claude API (creates website)
          ‚Üí Pull Request (code review)
            ‚Üí Netlify Preview (deployment)
              ‚Üí Webhook (completion notification)
                ‚Üí Convex (updates database)
                  ‚Üí User (shows preview URL)
```

## Testing

### Test Payloads

Use payloads from `/WaaS/test-payloads/`:

```bash
# View test payload
cat ../test-payloads/1-nexusai-tech-startup.json

# Trigger via GitHub Actions UI
# Copy JSON values into workflow form fields
```

### Test Checklist

- [ ] Workflow triggers successfully
- [ ] AI generation completes without errors
- [ ] Generated Astro file is valid
- [ ] PR created with correct labels
- [ ] Netlify preview URL works
- [ ] Webhook notifications sent
- [ ] Design is industry-appropriate
- [ ] Website is mobile-responsive
- [ ] Accessibility standards met

## Common Issues

### Workflow Fails at AI Generation

**Symptoms**: Python script errors, API timeouts, malformed output

**Solutions**:
- Check `ANTHROPIC_API_KEY` is valid and has quota
- Review Claude API response for errors
- Ensure prompt structure is correct
- Check for rate limiting or API outages

### Generated Website Has Errors

**Symptoms**: Build fails, runtime errors, missing imports

**Solutions**:
- Review generated `index.astro` file
- Check for invalid Tailwind classes
- Verify all imports are available (React, Framer Motion, lucide-react)
- Ensure AI followed prompt requirements (Tailwind CSS only, no custom files)

### Netlify Preview Not Working

**Symptoms**: 404 errors, build failures on Netlify

**Solutions**:
- Verify Netlify site is connected to repository
- Check build settings (command: `npm run build`, dir: `dist`)
- Enable PR preview deployments in Netlify settings
- Review Netlify build logs for errors

## Design Quality Assurance

### What Makes a Good Generated Website

‚úÖ **Industry-appropriate aesthetic** - Tech looks modern, law looks traditional
‚úÖ **Responsive design** - Works on mobile, tablet, desktop
‚úÖ **Accessible** - Semantic HTML, proper contrast, keyboard navigation
‚úÖ **Performance-optimized** - Minimal JS, optimized images, fast load
‚úÖ **SEO-ready** - Meta tags, semantic structure, descriptive text
‚úÖ **Professional polish** - Consistent spacing, typography, color usage

### Red Flags to Watch For

‚ùå **Generic template feel** - Looks like every other AI-generated site
‚ùå **Poor mobile UX** - Broken layouts, tiny text, inaccessible buttons
‚ùå **Accessibility issues** - Missing alt text, poor contrast, no focus states
‚ùå **Inconsistent branding** - Random colors, mismatched fonts
‚ùå **Performance problems** - Large bundle size, slow load, excessive JS
‚ùå **Code quality issues** - Duplicate code, unused imports, invalid HTML

## Maintenance Guidelines

### When to Update Dependencies

- **Astro**: Update to latest stable within major version (5.x)
- **Tailwind CSS**: Stay on v4+ (CSS-first architecture)
- **React**: Keep at latest stable (19.x currently)
- **Framer Motion**: Update for new animation features
- **lucide-react**: Update for new icons

### When NOT to Add Features

Don't add:
- Pre-built components (defeats the purpose)
- Template systems (use base-template instead)
- Complex build processes (keep it minimal)
- Custom styling systems (Tailwind CSS only)
- Additional frameworks (Astro + React only)

## Architecture Decisions

### Why No Config File for Tailwind?

Tailwind v4 uses CSS-first configuration via `@import "tailwindcss"`. This:
- Reduces boilerplate
- Simplifies setup
- Gives AI more freedom
- Aligns with minimal philosophy

### Why Single-Call AI Generation?

Generating the entire website in one Claude API call:
- Ensures design consistency
- Reduces generation time
- Simplifies workflow
- Gives AI complete creative control

### Why No Component Library?

Pre-built components would:
- Constrain AI creativity
- Encourage template-like patterns
- Limit design exploration
- Defeat the "minimal" purpose

## Support and Troubleshooting

For issues with:
- **Workflow**: Check GitHub Actions logs
- **AI Generation**: Review Claude API responses
- **Deployment**: Check Netlify build logs
- **Architecture**: See `/WaaS/CLAUDE.md` for ecosystem context

## Related Documentation

- `/WaaS/CLAUDE.md` - WaaS ecosystem overview
- `/WaaS/base-template/CLAUDE.md` - Template-based generation
- `README.md` - User-facing documentation
- `.github/workflows/generate-client-site.yml` - Workflow implementation

---

ü§ñ **Remember**: Base-minimal exists to give AI complete creative freedom. Don't add templates, components, or constraints that would limit this freedom.
